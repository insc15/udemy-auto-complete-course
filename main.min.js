"use strict";var __awaiter=this&&this.__awaiter||function(e,o,i,s){function r(c){return c instanceof i?c:new i(function(n){n(c)})}return new(i||(i=Promise))(function(c,n){function u(t){try{d(s.next(t))}catch(l){n(l)}}function a(t){try{d(s.throw(t))}catch(l){n(l)}}function d(t){t.done?c(t.value):r(t.value).then(u,a)}d((s=s.apply(e,o||[])).next())})},_a,_b,_c;const courseID=(_c=(_b=(_a=document.querySelector("div[data-module-id=course-taking]"))===null||_a===void 0?void 0:_a.getAttribute("data-module-args"))===null||_b===void 0?void 0:_b.match(/"course_id":(\d+)/))===null||_c===void 0?void 0:_c[1];function getLectures(e){return __awaiter(this,void 0,void 0,function*(){console.clear(),console.log("Getting lectures...");const s=(yield(yield fetch(`https://fpl.udemy.com/api-2.0/courses/${e}/subscriber-curriculum-items/?page_size=200&fields[lecture]=title,object_index,is_published,sort_order,created,asset,supplementary_assets,is_free&fields[quiz]=title,object_index,is_published,sort_order,type&fields[practice]=title,object_index,is_published,sort_order&fields[chapter]=title,object_index,is_published,sort_order&fields[asset]=title,filename,asset_type,status,time_estimation,is_external&caching_intent=True`)).json()).results.filter(r=>r._class==="lecture");return console.log("Got lectures"),s})}function completeLecture(e){return __awaiter(this,void 0,void 0,function*(){e.forEach(o=>__awaiter(this,void 0,void 0,function*(){(yield fetch(`https://fpl.udemy.com/api-2.0/users/me/subscribed-courses/${courseID}/completed-lectures/`,{method:"POST",headers:{"content-type":"application/json;charset=UTF-8"},body:JSON.stringify({lecture_id:o.id,downloaded:!1})})).status===201&&console.log("Completed lecture: "+o.title)}))})}getLectures(courseID).then(e=>{completeLecture(e)});
